<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu App PWA</title>

    <!-- Link para o arquivo de manifesto -->
    <link rel="manifest" href="manifest.json">

    <!-- Adicionando um ícone (opcional, mas recomendado para PWA) -->
    <link rel="icon" type="image/png" href="/icons/icon-192x192.png">

    <!-- Meta tags para PWA (opcional, mas recomendado) -->
    <meta name="theme-color" content="#2F3BA2">
</head>
<body>
    <h1>Meu Aplicativo PWA</h1>
    <p>Este é um exemplo de aplicativo progressivo para a web.</p>

    <!-- Botão para instalar -->
    <button id="installBtn" style="display:none;">Instalar App</button>

    <script>
        let deferredPrompt;

        // Verifica se o navegador suporta Service Workers
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js')
                .then(function(registration) {
                    console.log('Service Worker registrado com sucesso:', registration);
                })
                .catch(function(error) {
                    console.log('Falha ao registrar o Service Worker:', error);
                });
        }

        // Ouve o evento 'beforeinstallprompt' e armazena o prompt
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            document.getElementById('installBtn').style.display = 'block';
        });

        // Lida com o clique no botão de instalação
        const installBtn = document.getElementById('installBtn');
        installBtn.addEventListener('click', async () => {
            installBtn.style.display = 'none';
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            if (outcome === 'accepted') {
                console.log('Usuário aceitou a instalação do PWA');
            } else {
                console.log('Usuário recusou a instalação do PWA');
            }
            deferredPrompt = null;
        });
    </script>
</body>
</html>
